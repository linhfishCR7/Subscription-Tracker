<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Subscription Tracker ‚Äì PWA + Firebase + Gmail + Google Calendar</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6ee7ff" />
  <link rel="icon" href="icon-192.png" />

  <!-- Firebase (v11 CDN) -->
  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore.js"></script>

  <!-- Google Identity Services (OAuth) -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <link rel="stylesheet" href="app.css">
</head>
<body>
<div class="wrap">
  <h1>Subscription Tracker</h1>
  <div class="sub">PWA + Firestore sync + Gmail scan + <b>Google Calendar auto-sync</b>. üßä</div>

  <div class="card">
    <div class="authbar">
      <button id="btnLogin">ƒêƒÉng nh·∫≠p Google</button>
      <button id="btnLogout" class="ghost hidden">ƒêƒÉng xu·∫•t</button>
      <button id="btnGmail" class="ghost hidden">K·∫øt n·ªëi Gmail (scan ho√° ƒë∆°n)</button>
      <button id="btnCalendar" class="ghost hidden">K·∫øt n·ªëi Calendar (auto-sync)</button>
      <span id="userInfo" class="small muted"></span>
    </div>
    <div class="cap small" id="supportNote"></div>
  </div>

  <div class="grid cols-2" style="margin-top:14px">
    <div class="card">
      <h3>Th√™m / S·ª≠a thu√™ bao</h3>
      <div class="row">
        <div><label>T√™n d·ªãch v·ª•</label><input id="name" placeholder="V√≠ d·ª•: Google One 2TB"></div>
        <div><label>Nh√† cung c·∫•p</label><input id="provider" placeholder="Google, Apple, Adobe‚Ä¶"></div>
      </div>
      <div class="row">
        <div><label>Gi√° m·ªói k·ª≥</label><input id="price" type="number" step="0.01" placeholder="vd 199000"></div>
        <div><label>Ti·ªÅn t·ªá</label><input id="currency" placeholder="VND, USD‚Ä¶" value="VND"></div>
      </div>
      <div class="row">
        <div>
          <label>Chu k·ª≥ thanh to√°n</label>
          <select id="cycle">
            <option value="monthly">H√†ng th√°ng</option>
            <option value="yearly">H√†ng nƒÉm</option>
            <option value="weekly">H√†ng tu·∫ßn</option>
            <option value="custom">T√πy ch·ªânh (ng√†y)</option>
          </select>
        </div>
        <div id="customDaysWrap" class="hidden">
          <label>S·ªë ng√†y m·ªói k·ª≥</label><input id="customDays" type="number" min="1" value="30">
        </div>
      </div>
      <div class="row">
        <div><label>Ng√†y b·∫Øt ƒë·∫ßu ho·∫∑c l·∫ßn thanh to√°n g·∫ßn nh·∫•t</label><input id="startDate" type="date"></div>
        <div><label>Nh·∫Øc tr∆∞·ªõc (ng√†y)</label><input id="remindBefore" type="number" value="7" min="0"></div>
      </div>
      <div class="row">
        <div><label>Th·∫ª (tags)</label><input id="tags" placeholder="gia ƒë√¨nh, c√¥ng vi·ªác‚Ä¶ (ph√¢n t√°ch b·ªüi d·∫•u ph·∫©y)"></div>
        <div><label>Tr·∫°ng th√°i</label>
          <select id="status">
            <option value="active" selected>ƒêang d√πng</option>
            <option value="paused">T·∫°m d·ª´ng</option>
            <option value="cancelled">ƒê√£ h·ªßy</option>
          </select>
        </div>
      </div>
      <label>Ghi ch√∫</label><textarea id="notes" placeholder="ID h√≥a ƒë∆°n, email ƒëƒÉng k√Ω, k√™nh thanh to√°n, g√≥i c∆∞·ªõc‚Ä¶"></textarea>
      <div class="toolbar" style="margin-top:8px">
        <button id="saveBtn">L∆∞u thu√™ bao</button>
        <button class="ghost" id="resetBtn">L√†m m·ªõi</button>
        <button class="ghost" id="enableNotify">B·∫≠t th√¥ng b√°o & l·ªãch n·ªÅn</button>
        <span class="right small muted">T·ª± ƒë·ªông ƒë·ªìng b·ªô Google Calendar n·∫øu ƒë√£ k·∫øt n·ªëi</span>
      </div>
      <input type="hidden" id="editId" />
    </div>

    <div class="card">
      <h3>Ti·ªán √≠ch</h3>
      <div class="toolbar" style="margin-bottom:8px">
        <input id="search" placeholder="T√¨m theo t√™n / nh√† cung c·∫•p / tag" />
        <select id="filterStatus">
          <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
          <option value="active">ƒêang d√πng</option>
          <option value="paused">T·∫°m d·ª´ng</option>
          <option value="cancelled">ƒê√£ h·ªßy</option>
        </select>
      </div>
      <div class="toolbar">
        <button id="exportJSON">Xu·∫•t JSON</button>
        <button class="ghost" id="importJSON">Nh·∫≠p JSON</button>
        <button class="ghost" id="exportCSV">Xu·∫•t CSV</button>
        <button class="ghost" id="downloadICS">T·∫£i l·ªãch .ics (t·∫•t c·∫£)</button>
      </div>
      <div class="small muted" style="margin-top:6px">Android: Periodic Background Sync; iOS/macOS: c√≥ Google Calendar nh·∫Øc qua cloud, kh·ªèi c·∫ßn .ics.</div>
    </div>
  </div>

  <div class="card" style="margin-top:14px">
    <div class="toolbar">
      <div class="small muted">S·∫Øp x·∫øp theo:</div>
      <select id="sortBy">
        <option value="next">Ng√†y gia h·∫°n (g·∫ßn nh·∫•t)</option>
        <option value="name">T√™n</option>
        <option value="price">Gi√°</option>
        <option value="provider">Nh√† cung c·∫•p</option>
      </select>
      <select id="sortDir">
        <option value="asc">TƒÉng d·∫ßn</option>
        <option value="desc">Gi·∫£m d·∫ßn</option>
      </select>
      <div class="right small muted nowrap" id="totals"></div>
    </div>
    <table id="table">
      <thead><tr>
        <th>T√™n</th><th>Nh√† cung c·∫•p</th><th>Gi√°/k·ª≥</th><th>Chu k·ª≥</th>
        <th>Ti·∫øn ƒë·ªô k·ª≥</th><th>Gia h·∫°n ti·∫øp theo</th><th>Nh·∫Øc</th><th>Th·∫ª</th><th></th>
      </tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
